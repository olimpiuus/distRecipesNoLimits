import{r as s,j as o,i as D,o as C,L as z,a as N,b as A}from"../chunks/chunk-BuLkwGUr.js";import{R as _}from"../chunks/chunk-Cvvvrain.js";/* empty css                      */import"../chunks/chunk-CXsRlRas.js";/* empty css                      *//* empty css                      *//* empty css                      */function L(){const[l,E]=s.useState(""),[u,y]=s.useState(!1),[S,k]=s.useState(null),[c,h]=s.useState([]);s.useRef("");const m=s.useRef(null);s.useEffect(()=>{const d=new URLSearchParams(window.location.search).get("q")||"";E(d)},[]),s.useEffect(()=>{if(!l){h([]);return}const a=`searchRecipes_${l}`,d=sessionStorage.getItem(a);if(d)try{const n=JSON.parse(d);h(n)}catch(n){console.error("Failed to parse cached recipes:",n),w(l)}else w(l);return()=>{m.current&&m.current.abort()}},[l]),s.useEffect(()=>{if(l&&c.length>0){const a=`searchRecipes_${l}`;sessionStorage.setItem(a,JSON.stringify(c))}},[c,l]);const x=s.useCallback(a=>{const{type:d,id:n,data:p,imageUrl:j,message:P,error:T}=a;switch(d){case"start":case"startAI":break;case"DbData":try{h(e=>{const r=e.findIndex(i=>i._id===n);if(r!==-1){const i=[...e];return i[r]={...i[r],...p},i}else return[...e,{_id:n,...p}]})}catch(e){console.error("Error parsing data chunk:",e)}break;case"data":try{const e=JSON.parse(p);h(r=>{const i=r.findIndex(t=>t._id===n);if(i!==-1){const t=[...r];return t[i]={...t[i],...e},t}else return[...r,{_id:n,...e}]})}catch(e){console.error("Error parsing data chunk:",e)}break;case"image":h(e=>e.map(r=>r._id===n?{...r,imageUrl:j}:r));break;case"complete":break;case"end":break;case"error":k(`Error fetching meal with ID ${n}: ${T}`);break}},[]),w=s.useCallback(async(a,d=[])=>{const p=(e=>{const r=e.split(".");return r.length>2&&r.shift(),r.join(".")})(window.location.host),P=`${`${window.location.protocol}//api.${p}`}/api/recipes/customReceipt?search=${encodeURIComponent(a)}&loadedMeals=${encodeURIComponent(d.join(","))}`;m.current=new AbortController;const{signal:T}=m.current;try{const e=await fetch(P,{signal:T});if(!e.ok)throw new Error("Failed to fetch meal data");const r=e.body.getReader(),i=new TextDecoder;y(!0);let t="";for(;;){const{value:f,done:U}=await r.read();if(U){y(!1);break}t+=i.decode(f,{stream:!0});let g=t.indexOf(`
`);for(;g!==-1;){const b=t.slice(0,g).trim();if(t=t.slice(g+1),b)try{const v=JSON.parse(b);x(v)}catch(v){console.error("Failed to parse JSON chunk:",v,"Chunk:",b)}g=t.indexOf(`
`)}}if(t.trim())try{const f=JSON.parse(t.trim());x(f)}catch(f){console.error("Failed to parse JSON chunk from remaining buffer:",f,"Buffer:",t)}}catch(e){e.name!=="AbortError"&&(k(e.message),console.error("Error fetching streamed data:",e),y(!1))}},[x]),R=()=>{const a=c.map(d=>d.name);w(l,a)};return s.useEffect(()=>{},[c]),o.jsxs("div",{className:"p-4",children:[o.jsxs("h1",{className:"text-2xl font-semibold mb-4",children:['Search Results for "',l,'"']}),S&&o.jsx("div",{className:"alert alert-error shadow-lg mb-4",children:o.jsxs("div",{children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9z"})}),o.jsx("span",{children:S})]})}),c.length===0&&!u&&!S&&o.jsx("div",{className:"text-gray-600",children:"No recipes found for your search."}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[c.map(a=>a.name&&o.jsx(_,{recipe:a},a._id)),o.jsx("button",{onClick:R,disabled:u,className:`card shadow-lg hover:shadow-xl transition-shadow flex items-center justify-center p-4 border border-gray-300 rounded-lg bg-white hover:bg-gray-100 ${u?"cursor-not-allowed opacity-50":"cursor-pointer"}`,children:u?"Loading...":"Load More"})]}),u&&o.jsx("div",{className:"mt-4 text-blue-500",children:"Loading recipes..."})]})}function I(){return o.jsx(L,{})}const O=Object.freeze(Object.defineProperty({__proto__:null,Page:I},Symbol.toStringTag,{value:"Module"})),K={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/components/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:D}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:C}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.jsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:z}]},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.js",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:N}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.js",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:A}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/search/+Page.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:O}},hooksTimeout:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/search/+config.js",fileExportPathToShowToUser:["default","hooksTimeout"]},valueSerialized:{type:"js-serialized",value:{data:{warning:!1,error:!1,onRenderClient:!1}}}}};export{K as configValuesSerialized};
